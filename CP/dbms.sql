CREATE TABLE PRODUCT_MASTER1 (ProduCt_no VARCHAR2(6) PRIMARY KEY CHECK(ProduCt_no LIKE 'P%') , Description VARCHAR2(15) NOT NULL, QTY_ON_HAND NUMBER(8) NOT NULL,
Sell_Price NUMBER(8,2) NOT NULL  CHECK(Sell_Price <> 0),  Cost_Price NUMBER(8,2) NOT NULL  CHECK(Cost_Price <> 0))

CREATE TABLE SALESMAN_MASTER (Salesman_no VARCHAR2(6) PRIMARY KEY CHECK(Salesman_no LIKE 'S%') , Salesman_name VARCHAR2(20) NOT NULL , 
City VARCHAR2(20) NOT NULL , Pincode NUMBER(8) NOT NULL , Sal_Amt NUMBER(8,2) NOT NULL CHECK(Sal_Amt <> 0)



CREATE TABLE SALES_ORDER(Order_no VARCHAR2(6) PRIMARY KEY CHECK(Order_no LIKE 'O%'), 
FOREIGN KEY(Client_no) REFERENCES CLIENT_MASTER(Client_no),
Order_date DATE,
FOREIGN KEY(Salesman_no) REFERENCES SALESMAN_MASTER(Salesman_no),
Dely_type CHAR(1) DEFAULT 'F' CHECK(Dely_type IN('P','F')),
Dely_date DATE)


FOREIGN KEY(Order_no)) REFERENCES SALES_ORDER(Order_no),
FOREIGN KEY(ProduCt_no) REFERENCES PRODUCT_MASTER1(ProduCt_no),
Qty_disp NUMBER(8)),
ProduCt_rate NUMBER(10,2))



CREATE TABLE CLIENT_MASTER (Client_no VARCHAR2(6) PRIMARY KEY CHECK(Client_no LIKE 'C%'),
Name VARCHAR2(20) NOT NULL,
City VARCHAR2(15),
Pincode NUMBER(8),
State VARCHAR2(15),
BalDue NUMBER(10,2));


CREATE TABLE PRODUCT_MASTER (ProduCt_no VARCHAR2(6) PRIMARY KEY CHECK(ProduCt_no LIKE 'P%'),
Description VARCHAR2(15) NOT NULL,
QTY_ON_HAND NUMBER(8) NOT NULL,
Sell_Price NUMBER(8,2) NOT NULL CHECK (Sell_Price <> 0),
Cost_Price NUMBER(8,2) NOT NULL CHECK(Cost_Price <>0));


CREATE table SALESMAN_MASTER(Salesman_no VARCHAR2(6) PRIMARY KEY CHECK (Salesman_no LIKE 'S%'),
Salesman_name VARCHAR2(20) NOT NULL,
City VARCHAR2(20) NOT NULL,
Pincode VARCHAR2(8) NOT NULL, 
State VARCHAR2(20) NOT NULL,
Sal_Amt NUMBER(8,2) NOT NULL CHECK(Sal_Amt <> 0));




CREATE TABLE SALES_ORDER(Order_no VARCHAR2(6) PRIMARY KEY CHECK(Order_no LIKE 'O%'),
Client_no  VARCHAR2(6)  REFERENCES CLIENT_MASTER(Client_no) ON DELETE CASCADE,
Order_date DATE,
Salesman_no VARCHAR2(6)  REFERENCES SALESMAN_MASTER(Salesman_no) ON DELETE CASCADE,
Dely_type CHAR(1) DEFAULT 'F' CHECK (Dely_type in ('P','F')),
Dely_date DATE
);


CREATE TABLE SALES_ORDER_DETAILS (Order_no VARCHAR2(6) REFERENCES SALES_ORDER(Order_no) ON DELETE CASCADE,
ProduCt_no VARCHAR2(6) REFERENCES PRODUCT_MASTER(ProduCt_no) ON DELETE CASCADE,
Qty_disp NUMBER(8),
ProduCt_rate NUMBER(10,2));



INSERT INTO CLIENT_MASTER VALUES ('C006', 'SIVA JI', 'Mummbai', 474001, 'Maharastra', 52561.52);

INSERT INTO CLIENT_MASTER VALUES ('C00001', 'Raj', 'Kolkata', 800001, 'W.B', 200);

INSERT INTO CLIENT_MASTER VALUES ('C00003', 'Anand', 'Kolkata', 800001, 'W.B', 200);
INSERT INTO CLIENT_MASTER VALUES ('C007', 'Pranav', 'Purnia', 800043, 'Bihar', 20000);


INSERT INTO CLIENT_MASTER VALUES ('C007', 'SINDE', 'Mummbai', 474001, 'Maharastra', 561.52);

INSERT INTO CLIENT_MASTER VALUES ('C008', 'DHONI', 'Chennai', 474112, 'Tamilnadu', 52561.52);



INSERT INTO Product_master VALUES ('P03', 'Computer Books', 100, 520.00,340.70);
INSERT INTO Product_master VALUES ('P04', 'Math Books', 100, 320.00,250.50);
INSERT INTO Product_master VALUES ('P05', 'Trousers', '100', 420.00,200.50);
INSERT INTO Product_master VALUES ('P01', 'Shoes', '500', 4210.00,2000.50);
INSERT INTO Product_master VALUES ('P02', 'Saree', '10', 820.00,600.50);

INSERT INTO SALESMAN_MASTER VALUES ('S01', 'Pratik', 'Kolkata', '700063', 'W.B', 500);
INSERT INTO SALESMAN_MASTER VALUES ('S02', 'Pranay', 'Kolkata', '700023', 'W.B', 2500);
INSERT INTO SALESMAN_MASTER VALUES ('S03', 'Surajj', 'Kolkata', '700009', 'W.B', 3500);
INSERT INTO SALESMAN_MASTER VALUES ('S04', 'Sanbid', 'Kolkata', '700102', 'W.B', 3500);

INSERT INTO SALESMAN_MASTER VALUES ('S05', 'Nikhil', 'Kolkata', '700009', 'W.B', 700);


INSERT INTO SALESMAN_MASTER VALUES ('S06', 'Satyam', 'Kolkata', '700009', 'W.B', 3000);

INSERT INTO SALES_ORDER VALUES ('O1',(SELECT Client_no FROM CLIENT_MASTER WHERE Client_no='C001'),
TO_DATE('23/02/2012','DD/MM/YYYY'),
(SELECT Salesman_no FROM SALESMAN_MASTER WHERE Salesman_no='S01'),
'P',
TO_DATE('25/02/2012','DD/MM/YYYY'));


INSERT INTO SALES_ORDER VALUES ('O2',(SELECT Client_no FROM CLIENT_MASTER WHERE Client_no='C002'),
TO_DATE('23/08/2012','DD/MM/YYYY'),
(SELECT Salesman_no FROM SALESMAN_MASTER WHERE Salesman_no='S01'),
'P',
TO_DATE('25/08/2012','DD/MM/YYYY'));


INSERT INTO SALES_ORDER VALUES ('O6',(SELECT Client_no FROM CLIENT_MASTER WHERE Client_no='C00001'),
TO_DATE('11/06/2012','DD/MM/YYYY'),
(SELECT Salesman_no FROM SALESMAN_MASTER WHERE Salesman_no='S01'),
'P',
TO_DATE('15/11/2012','DD/MM/YYYY'));


INSERT INTO SALES_ORDER VALUES ('O4',(SELECT Client_no FROM CLIENT_MASTER WHERE Client_no='C005'),
TO_DATE('23/02/2012','DD/MM/YYYY'),
(SELECT Salesman_no FROM SALESMAN_MASTER WHERE Salesman_no='S01'),
'P',
TO_DATE('25/02/2012','DD/MM/YYYY'));



INSERT INTO SALES_ORDER VALUES ('O5',(SELECT Client_no FROM CLIENT_MASTER WHERE Client_no='C004'),
TO_DATE('23/02/2012','DD/MM/YYYY'),
(SELECT Salesman_no FROM SALESMAN_MASTER WHERE Salesman_no='S01'),
'P',
TO_DATE('25/02/2012','DD/MM/YYYY'));

INSERT INTO SALES_ORDER_DETAILS VALUES((SELECT Order_no FROM SALES_ORDER WHERE Order_no='O1'),
(SELECT ProduCt_no FROM PRODUCT_MASTER WHERE ProduCt_no='P01' ),
1234,
123.15);

INSERT INTO SALES_ORDER_DETAILS VALUES((SELECT Order_no FROM SALES_ORDER WHERE Order_no='O2'),
(SELECT ProduCt_no FROM PRODUCT_MASTER WHERE ProduCt_no='P02' ),
4567,
12113.15);
INSERT INTO SALES_ORDER_DETAILS VALUES((SELECT Order_no FROM SALES_ORDER WHERE Order_no='O3'),
(SELECT ProduCt_no FROM PRODUCT_MASTER WHERE ProduCt_no='P03' ),
1234,
123.15);
INSERT INTO SALES_ORDER_DETAILS VALUES((SELECT Order_no FROM SALES_ORDER WHERE Order_no='O4'),
(SELECT ProduCt_no FROM PRODUCT_MASTER WHERE ProduCt_no='P04' ),
12,
123.15);
INSERT INTO SALES_ORDER_DETAILS VALUES((SELECT Order_no FROM SALES_ORDER WHERE Order_no='O5'),
(SELECT ProduCt_no FROM PRODUCT_MASTER WHERE ProduCt_no='P05' ),
888,
888.15);


INSERT INTO SALES_ORDER_DETAILS VALUES((SELECT Order_no FROM SALES_ORDER WHERE Order_no='O8'),
(SELECT ProduCt_no FROM PRODUCT_MASTER WHERE ProduCt_no='P05' ),
888,
888.15);

INSERT INTO SALES_ORDER_DETAILS VALUES((SELECT Order_no FROM SALES_ORDER WHERE Order_no='O6'),
(SELECT ProduCt_no FROM PRODUCT_MASTER WHERE ProduCt_no='P05' ),
888,
888.15);



SELECT NAME FROM CLIENT_MASTER;
SELECT * FROM CLIENT_MASTER;
SELECT NAME,City, State FROM CLIENT_MASTER;
SELECT Description FROM PRODUCT_MASTER;
SELECT NAME FROM CLIENT_MASTER WHERE CITY = 'Mumbai';
SELECT NAME FROM SALESMAN_MASTER WHERE Sal_Amt = 3000;
SELECT * FROM PRODUCT_MASTER ORDER BY Cost_Price ASC;
SELECT DISTINCT FROM Sal_Amt FROM SALESMAN_MASTER;
SELECT * FROM PRODUCT_MASTER WHERE ProduCt_no IN (SELECT MIN(ProduCt_no) FROM PRODUCT_MASTER GROUP BY QTY_ON_HAND);


UPDATE CLIENT_MASTER SET CITY = 'Bangalore' WHERE Client_no='C001';

UPDATE CLIENT_MASTER SET BalDue=1000 WHERE Client_no='C006';

UPDATE PRODUCT_MASTER SET Cost_Price=950 WHERE Description='Trousers';
UPDATE SALESMAN_MASTER SET CITY='Pune' WHERE Salesman_no='S01';




ALTER TABLE CLIENT_MASTER 
ADD TELEPHONE NUMBER(10);

ALTER TABLE PRODUCT_MASTER
MODIFY Sell_Price NUMBER(10,2);


ALTER TABLE PRODUCT_MASTER DROP COLUMN Cost_Price;

DELETE FROM SALESMAN_MASTER WHERE Sal_Amt = 3500;

DELETE FROM PRODUCT_MASTER WHERE QTY_ON_HAND = 100;

DELETE FROM CLIENT_MASTER WHERE State = 'Tamilnadu';


ALTER TABLE SALESMAN_MASTER RENAME TO Sman_Mast;

ALTER TABLE SALES_ORDER DROP CONSTRAINT "Client_no";

DROP TABLE CLIENT_MASTER;




SELECT NAME FROM CLIENT_MASTER WHERE NAME LIKE '__a%';


SELECT * FROM CLIENT_MASTER WHERE CITY LIKE 'K%';

SELECT * FROM CLIENT_MASTER WHERE CITY IN ('Mumbai','Kolkata');

SELECT * FROM CLIENT_MASTER WHERE BalDue > 1000;
-- SELECT * FROM SALES_ORDER WHERE 

SELECT * FROM SALES_ORDER WHERE to_char(Order_date,'FMMONTH') ='JUNE';


SELECT * FROM SALES_ORDER_DETAILS SD JOIN SALES_ORDER SO ON SO.Order_no=SD.Order_no
WHERE SO.Client_no IN ('C00001','C00003');

SELECT *  FROM PRODUCT_MASTER WHERE Sell_Price >500 AND Sell_Price<=750;

SELECT COUNT(*) FROM SALES_ORDER;

SELECT MAX(Sell_Price) AS max_price , MIN(Sell_Price) AS min_price FROM PRODUCT_MASTER;


SELECT COUNT(*) FROM CLIENT_MASTER WHERE CITY ='Kolkata';


SELECT COUNT(*)  FROM PRODUCT_MASTER WHERE Sell_Price <=500 ;

SELECT Order_no, to_char(Order_date,'DAY') FROM SALES_ORDER;

SELECT to_char(Order_date,'DD-MONTH-YYYY') AS ORDER_DAY FROM SALES_ORDER;


SELECT SYSDATE + 20 FROM DUAL;


SELECT NAME FROM CLIENT_MASTER WHERE BalDue = (SELECT MAX(BalDue) FROM CLIENT_MASTER);


SELECT MAX(BalDue) - MIN(BalDue) AS DIFFERENCE FROM CLIENT_MASTER;


UPDATE SALESMAN_MASTER SET Sal_Amt=Sal_Amt+1000; USE FIRST;




CREATE TABLE EMPLOYEE(EMP_NO VARCHAR2(8) PRIMARY KEY,NAME VARCHAR2(15),DOB DATE,SEX CHAR CHECK (SEX IN ('F','M','O')),
ADDRESS VARCHAR2(20),SALARY NUMBER(15,2)
);


CREATE TABLE COMPANY(COMP_NO VARCHAR2(8) PRIMARY KEY,NAME VARCHAR2(20) ,  ADDRESS VARCHAR2(20));


CREATE TABLE WORKS(EMP_NO VARCHAR2(8) REFERENCES EMPLOYEE(EMP_NO),
COMP_NO VARCHAR2(8) REFERENCES COMPANY(COMP_NO));


INSERT INTO EMPLOYEE VALUES('E1','RAHUL KUMAR',TO_DATE('23/02/2000','DD/MM/YYYY'),'M','PATNA',999999);

INSERT INTO EMPLOYEE VALUES('E2','PRANAV',TO_DATE('23/02/1999','DD/MM/YYYY'),'M','PURNIA',10000);

INSERT INTO EMPLOYEE VALUES('E3','PRATIK',TO_DATE('23/02/2000','DD/MM/YYYY'),'M','KOLKATA',100057);

INSERT INTO EMPLOYEE VALUES('E4','ROOPKATHA',TO_DATE('23/02/1999','DD/MM/YYYY'),'M','KOLKATA',10000);

INSERT INTO COMPANY VALUES('C00002','Clifford Corp','KOLKATA');

INSERT INTO COMPANY VALUES('C00004','GOOGLE','MOUNTAIN VIEW');

INSERT INTO COMPANY VALUES('C00001','APPLE','CUPERTINO');

INSERT INTO WORKS VALUES('E1','C00004');

INSERT INTO WORKS VALUES('E2','C00001');
INSERT INTO WORKS VALUES('E3','C00002');
INSERT INTO WORKS VALUES('E4','C00002');


 SELECT * FROM EMPLOYEE NATURAL JOIN WORKS WHERE COMP_NO = 'C00002';
 SELECT * FROM EMPLOYEE NATURAL JOIN WORKS WHERE COMP_NO = 'C00004';


SELECT * FROM EMPLOYEE WHERE EMP_NO in (SELECT EMP_NO FROM WORKS NATURAL JOIN COMPANY WHERE Name = 'Clifford Corp');


SELECT * FROM EMPLOYEE WHERE LOWER(NAME) LIKE '%a';

SELECT * FROM EMPLOYEE WHERE EXTRACT(YEAR FROM DOB)  BETWEEN 1999 AND 2011;



SELECT SNAME FROM STUDENT WHERE SNO  IN (
    SELECT SNO FROM WORKS WHERE PNO 
    NOT IN (SELECT PNO FROM PROJECT WHERE PNAME IN ('MS','MD'))
);


CREATE TABLE CUSTOMER(CID VARCHAR2(6) PRIMARY KEY CHECK(CID LIKE 'C%'),
Name VARCHAR2(20) NOT NULL,
City VARCHAR2(15),
Pincode NUMBER(8)
);

INSERT INTO CUSTOMER VALUES(
    'C2',
    'PRATIK',
    'KOLKATA',
    700102
);

INSERT INTO CUSTOMER VALUES(
    'C3',
    'XYZ',
    'KOLKATA',
    700102
);
INSERT INTO CUSTOMER VALUES(
    'C4',
    'ABC',
    'PATNA',
    80001
);
CREATE TABLE PHONE(
    PHONEID VARCHAR2(6) PRIMARY KEY CHECK (PHONEID LIKE 'PH%'),
  CID VARCHAR2(6)   REFERENCES Customer(CID) ON DELETE CASCADE,
    PNUMBER   NUMBER(10) NOT NULL
);
INSERT INTO PHONE VALUES(
    'PH2',
    'C2',
    1111111111
);
INSERT INTO PHONE VALUES(
    'PH3',
    'C3',
    9110144212
);
INSERT INTO PHONE VALUES(
    'PH4',
    'C4',
    8887744212
);
CREATE TABLE CAR(
    RNO VARCHAR2(15) PRIMARY KEY,
    CID VARCHAR2(6) REFERENCES CUSTOMER(CID) ON DELETE CASCADE,
    MODEL VARCHAR2(10) NOT NULL,
    COLOR VARCHAR2(10) NOT NULL,
    YEAR VARCHAR2(4) NOT NULL
);

INSERT INTO CAR VALUES(
    'AIBP2011',
    'C1',
    'FORTUNER',
    'RED',
    '2015'
);


INSERT INTO CAR VALUES(
    'AIBP2016',
    'C2',
    'CITY',
    'RED',
    '2011'
);
INSERT INTO CAR VALUES(
    'AIBP1777',
    'C4',
    'SCORPIO',
    'RED',
    '2018'
);

INSERT INTO CAR VALUES(
    'AIBP1999',
    'C3',
    'FERRARI',
    'RED',
    '2018'
);

INSERT INTO CAR VALUES(
    'AIBPC2010',
    'C3',
    'ASTON',
    'RED',
    '2018'
);

INSERT INTO CAR VALUES(
    'AIBPC2011',
    'C3',
    'SCORPIO',
    'RED',
    '2018'
);
CREATE TABLE POLICY(
    PID VARCHAR2(10) PRIMARY KEY,
    RNO  VARCHAR2(15) REFERENCES CAR(RNO) ON DELETE CASCADE
);

INSERT INTO POLICY VALUES(
    'PID2',
    'AIBP1998'
);
CREATE TABLE ACCIDENT(
    REPORTID VARCHAR2(15) PRIMARY KEY,
    RNO VARCHAR2(15) REFERENCES CAR(RNO) ON DELETE CASCADE, 
    PLACE VARCHAR2(15) ,
    ADATE DATE,
    DAMOUNT NUMBER(9,2)
);
INSERT INTO ACCIDENT VALUES(
    'FIR275',
    'AIBP2011',
    'KOLKATA',
    TO_DATE('23/08/2010','DD/MM/YYYY'),
    1000    
);

INSERT INTO ACCIDENT VALUES(
    'FIR271',
    'AIBPC2010',
    'KOLKATA',
    TO_DATE('23/08/2010','DD/MM/YYYY'),
    1000    
);
INSERT INTO ACCIDENT VALUES(
    'FIR273',
    'AIBP2021',
    'KOLKATA',
    TO_DATE('23/08/2011','DD/MM/YYYY'),
    1000    
);

CREATE TABLE PAMOUNT(
    PAYMENT_NO VARCHAR2(6) PRIMARY KEY,
    PID VARCHAR2(10) REFERENCES POLICY(PID) ON DELETE CASCADE,
    AMOUNT NUMBER(8,2) ,
    RECEIVED_ON DATE,
    DUE_DATE DATE
);


SELECT COUNT(CID) FROM CUSTOMER WHERE CID IN(
    SELECT CID FROM CAR WHERE RNO IN (
        SELECT RNO FROM ACCIDENT
    )
);




SELECT COUNT(*) FROM ACCIDENT WHERE
RNO IN (
    SELECT RNO FROM CAR WHERE CID =( SELECT CID FROM CUSTOMER WHERE NAME = 'XYZ')
);

DELETE FROM CAR WHERE MODEL = 'SCORPIO' AND CID = (SELECT CID FROM CUSTOMER WHERE NAME = 'XYZ');

UPDATE ACCIDENT
SET DAMOUNT = 5000
WHERE RNO='AIBPC2010' AND REPORTID = 'FIR271';


CREATE TABLE PAMOUNT(
    PAYMENT_NO VARCHAR2(6) PRIMARY KEY,
    PID VARCHAR2(10) REFERENCES POLICY(PID) ON DELETE CASCADE,
    AMOUNT NUMBER(8,2) ,
    RECEIVED_ON DATE,
    DUE_DATE DATE
);





CREATE TABLE MEDICINE(
    TRADENAME VARCHAR2(20) PRIMARY KEY,
    UNITPRICE NUMBER(6,2) NOT NULL,
    GFLAG CHAR DEFAULT 'F' NOT NULL
);

CREATE TABLE DOCTOR(
    SSN VARCHAR2(6) PRIMARY KEY,
    FNAME VARCHAR2(10) NOT NULL,
    LNAME VARCHAR2(10) NOT NULL,
    SPECIALITY VARCHAR2(10) NOT NULL,
    YOE NUMBER NOT NULL,
    PHONE NUMBER NOT NULL    
);

INSERT INTO DOCTOR VALUES(
    'D1',
    'YASHO',
    'WARDHAN',
    'SURGEON',
    1,
    1234567890
);
INSERT INTO DOCTOR VALUES(
    'D2',
    'ANJALI',
    'SINHA',
    'SURGEON',
    1,
    1234567891
);
INSERT INTO DOCTOR VALUES(
    'D3',
    'EKTA',
    'SINGH',
    'SURGEON',
    1,
    1234567892
);
INSERT INTO DOCTOR VALUES(
    'D4',
    'JOHN',
    'SMITH',
    'SURGEON',
    1,
    1234567893
);
INSERT INTO DOCTOR VALUES(
    'D5',
    'SHUBHAM',
    'RATHORE',
    'SURGEON',
    1,
    1234567894
);

CREATE TABLE PATIENT(
    SSN VARCHAR2(6) PRIMARY KEY,
    FNAME VARCHAR2(10) NOT NULL,
    LNAME VARCHAR2(10) NOT NULL,
    ADDRESS VARCHAR2(20) NOT NULL,
    DOB DATE NOT NULL,
    DSSN VARCHAR2(6) REFERENCES DOCTOR(SSN) ON DELETE CASCADE
);



INSERT INTO PATIENT VALUES(
    'P1',
    'PRANAV',
    'CHAUDHARY',
    'PATNA',
    TO_DATE('01/01/1998','DD/MM/YYYY'),
    'D4'
);


INSERT INTO PATIENT VALUES(
    'P2',
    'PRANAY',
    'PANDEY',
    'PATNA',
    TO_DATE('01/01/1998','DD/MM/YYYY'),
    'D4'
);

INSERT INTO PATIENT VALUES(
    'P3',
    'NIKHIL',
    'AGRAWAL',
    'PATNA',
    TO_DATE('01/01/1998','DD/MM/YYYY'),
    'D3'
);

INSERT INTO MEDICINE VALUES(
    'ASPIRIN',
    10,
    'T'
);


INSERT INTO MEDICINE VALUES(
    'VITAMIN',
    10,
    'T'
);

INSERT INTO MEDICINE VALUES(
    'XYZ',
    48,
    'F'
);

INSERT INTO MEDICINE VALUES(
    'ABC',
    38,
    'T'
);


CREATE TABLE PRESCRIPTION(
    ID VARCHAR2(6) PRIMARY KEY,
    PDATE DATE NOT NULL,
    DSSN VARCHAR2(6) REFERENCES DOCTOR(SSN) ON DELETE CASCADE,
    PSSN VARCHAR2(6) REFERENCES PATIENT(SSN) ON DELETE CASCADE
);

INSERT INTO PRESCRIPTION VALUES(
    'PR1',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D4',
    'P1'
);

INSERT INTO PRESCRIPTION VALUES(
    'PR2',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D4',
    'P2'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR3',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR4',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR5',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR6',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR7',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR8',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR9',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR10',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR11',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR12',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR13',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR14',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR15',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR16',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR17',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR18',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR19',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR20',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR21',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);

INSERT INTO PRESCRIPTION VALUES(
    'PR22',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
INSERT INTO PRESCRIPTION VALUES(
    'PR23',
    TO_DATE('01/01/2021','DD/MM/YYYY'),
    'D1',
    'P3'
);
CREATE TABLE PMEDICINE(
    ID VARCHAR2(6) REFERENCES PRESCRIPTION(ID) ON DELETE CASCADE,
    TRADENAME VARCHAR2(20) REFERENCES MEDICINE(TRADENAME) ON DELETE CASCADE,
    UNITS NUMBER NOT NULL
);

CREATE TABLE CINEMA (
    CID VARCHAR2(6) PRIMARY KEY,
    CNAME VARCHAR2(20),
    CITY VARCHAR2(20),
    OWNER_NAME VARCHAR2(20)
);

INSERT INTO CINEMA VALUES(
    'C1',
    'ROYAL CINEMA',
    'RAJKOT',
    'PRANAV'
);

INSERT INTO CINEMA VALUES(
    'C2',
    'CINEMA RAJKOT',
    'RAJKOT',
    'PRANAY'
);

INSERT INTO CINEMA VALUES(
    'C3',
    'ROYAL CINEMA',
    'MUMBAI',
    'NIKHIL'
);

INSERT INTO CINEMA VALUES(
    'C4',
    'HOLLYWOOD CINEMA',
    'MUMBAI',
    'PRATIK'
);

INSERT INTO CINEMA VALUES(
    'C5',
    'BOLLY CINEMA',
    'DELHI',
    'RAJ'
);

CREATE TABLE FILM(
    FID VARCHAR2(6) PRIMARY KEY,
    TITLE VARCHAR2(20) NOT NULL,
    DIRECTOR_NAME VARCHAR2(20) NOT NULL,
    GENRE VARCHAR2(20) NOT NULL,
    BUDGET NUMBER(15,2) ,
    RATING DECIMAL(2,1)
);
INSERT INTO FILM VALUES(
    'F1',
    'FAN',
    'SHAHRUKH KHAN',
    'ROMANCE',
    1000000005,
    4.5
);
INSERT INTO FILM VALUES(
    'F2',
    'FAST AND FURIOUS',
    'VIN DIESEL',
    'ACTION',
    100000000005,
    4.8
);


INSERT INTO FILM VALUES(
    'F3',
    '500 DAYS OF SUMMER',
    'BENJAMIN',
    'ROMANCE',
    10000000005,
    4.8
);

INSERT INTO FILM VALUES(
    'F3',
    'WOLF OF WALL STREET',
    'SCORSESE',
    'COMEDY',
    100000000005,
    4.8
);
INSERT INTO FILM VALUES(
    'F4',
    'BATMAN',
    'NOLAN',
    'ACTION',
    100000000005,
    4.8
);



INSERT INTO FILM VALUES(
    'F5',
    'LA LA LAND',
    'EMMA STONE ',
    'ROMANCE',
    100000000005,
    4.8
);
INSERT INTO FILM VALUES(
    'F6',
    'BAHUBALI',
    'EMMA STONE ',
    'ROMANCE',
    1005,
    4.8
);


CREATE TABLE SHOWING(  
    CID VARCHAR2(6) REFERENCES CINEMA(CID) ON DELETE CASCADE,    
    FID VARCHAR2(6) REFERENCES FILM(FID) ON DELETE CASCADE  
);

INSERT INTO SHOWING VALUES(
    'C1',
    'F2'
);

INSERT INTO SHOWING VALUES(
    'C1',
    'F6'
);
INSERT INTO SHOWING VALUES(
    'C1',
    'F3'
);
INSERT INTO SHOWING VALUES(
    'C1',
    'F1'
);
INSERT INTO SHOWING VALUES(
    'C2',
    'F2'
);

INSERT INTO SHOWING VALUES(
    'C2',
    'F2'
);
INSERT INTO SHOWING VALUES(
    'C2',
    'F1'
);
INSERT INTO SHOWING VALUES(
    'C2',
    'F6'
);
INSERT INTO SHOWING VALUES(
    'C2',
    'F4'
);
INSERT INTO SHOWING VALUES(
    'C2',
    'F5'
);


INSERT INTO SHOWING VALUES(
    'C3',
    'F5'
);

INSERT INTO SHOWING VALUES(
    'C3',
    'F1'
);

INSERT INTO SHOWING VALUES(
    'C4',
    'F2'
);

INSERT INTO SHOWING VALUES(
    'C4',
    'F1'
);

INSERT INTO SHOWING VALUES(
    'C5',
    'F6'
);

SELECT TITLE , DIRECTOR_NAME  FROM FILM NATURAL JOIN SHOWING 
NATURAL JOIN FILM WHERE BUDGET >=1000000000;

SELECT CNAME, CITY, TITLE FROM 
CINEMA NATURAL JOIN
SHOWING NATURAL JOIN
FILM
ORDER BY CITY, CNAME;


SELECT OWNER_NAME FROM CINEMA NATURAL JOIN
SHOWING NATURAL JOIN
FILM WHERE 
GENRE ='ROMANCE' AND NOT GENRE='COMEDY';

SELECT FID, TITLE, DIRECTOR_NAME FROM CINEMA NATURAL JOIN FILM 
NATURAL JOIN SHOWING WHERE CITY ='MUMBAI' AND BUDGET>=(
    SELECT MIN(BUDGET) FROM FILM NATURAL JOIN CINEMA NATURAL JOIN SHOWING WHERE CITY='RAJKOT'
);




INSERT INTO PMEDICINE VALUES(
    'PR1',
    'ASPIRIN',
    20
);

INSERT INTO PMEDICINE VALUES(
    'PR1',
    'VITAMIN',
    20
);

INSERT INTO PMEDICINE VALUES(
    'PR2',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR3',
    'ASPIRIN',
    20
);INSERT INTO PMEDICINE VALUES(
    'PR4',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR5',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR6',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR7',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR8',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR9',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR10',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR11',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR12',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR13',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR14',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR15',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR16',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR17',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR18',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR19',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR20',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR21',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR22',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR23',
    'ASPIRIN',
    20
);
INSERT INTO PMEDICINE VALUES(
    'PR24',
    'ABC',
    20
);


SELECT TRADENAME FROM MEDICINE WHERE 
GFLAG='T' AND UNITPRICE<=50;


SELECT FNAME,LNAME FROM PATIENT WHERE
DSSN = (
    SELECT SSN FROM DOCTOR WHERE
    FNAME = 'JOHN' AND LNAME = 'SMITH'
);

SELECT FNAME , LNAME FROM DOCTOR WHERE SSN NOT IN (
    SELECT DSSN FROM PATIENT
);

SELECT SSN FROM PATIENT WHERE SSN IN 
    (SELECT PSSN FROM PRESCRIPTION WHERE ID IN (
    SELECT ID FROM PMEDICINE WHERE
    TRADENAME = 'ASPIRIN' INTERSECT SELECT ID FROM PMEDICINE WHERE
    TRADENAME = 'VITAMIN'
    )
);


SELECT SSN FROM PATIENT WHERE SSN IN 
(
    SELECT PSSN FROM PRESCRIPTION WHERE ID IN  
    (
        SELECT ID FROM PMEDICINE  WHERE TRADENAME = 'ASPIRIN'
    ) AND DSSN  IN (SELECT SSN FROM DOCTOR WHERE FNAME = 'JOHN' AND LNAME = 'SMITH')
);

SELECT PSSN FROM PRESCRIPTION WHERE ID IN (SELECT ID FROM PMEDICINE WHERE TRADENAME = 'ASPIRIN');

SELECT FNAME, LNAME FROM PATIENT WHERE EXISTS (
    SELECT ID FROM PRESCRIPTION WHERE PRESCRIPTION.PSSN = PATIENT.SSN AND  PRESCRIPTION.DSSN = PATIENT.DSSN
);



SELECT TRADENAME , SUM(UNITS) FROM PMEDICINE
GROUP BY TRADENAME 
HAVING COUNT(TRADENAME) >20




--Create a new View Trigger

CREATE TRIGGER VIEW1TRIGGER1
INSTEAD OF INSERT ON VIEW1
BEGIN
    NULL;
END VIEW1;
/

--Create a new Table Trigger

CREATE TRIGGER TABLE1TRIGGER1
  BEFORE INSERT ON TABLE1
  BEGIN
    NULL;
  END TABLE1TRIGGER1;
/

--Create a new Schema Trigger

CREATE TRIGGER SCHEMATRIGGER1
  AFTER CREATE ON SCHEMA
  BEGIN
    NULL;
  END;
/

-- Create a new trigger on LOGON

CREATE TRIGGER DATABASETRIGGER1
AFTER LOGON ON DATABASE
BEGIN
   NULL;
END;
/



CREATE TABLE FILM(
    FID VARCHAR2(6) PRIMARY KEY,
    TITLE VARCHAR2(20) NOT NULL,
    DIRECTOR_NAME VARCHAR2(20) NOT NULL,
    GENRE VARCHAR2(20) NOT NULL,
    BUDGET NUMBER(15,2) ,
    RATING DECIMAL(2,1)
);


CREATE TABLE PRESCRIPTION(
    ID VARCHAR2(6) PRIMARY KEY,
    PDATE DATE NOT NULL,
    DSSN VARCHAR2(6) REFERENCES DOCTOR(SSN) ON DELETE CASCADE,
    PSSN VARCHAR2(6) REFERENCES PATIENT(SSN) ON DELETE CASCADE
);


CREATE TABLE RESTAURANTS(
    RID VARCHAR2(6) PRIMARY KEY,
    RNAME VARCHAR2(20) NOT NULL,
    RCITY VARCHAR2(20) NOT NULL,
    PHONE NUMBER(10),
    CAPACITY NUMBER(10) NOT NULL
);

CREATE TABLE DISHES(
    DID VARCHAR2(6) PRIMARY KEY,
    DNAME VARCHAR2(20)NOT NULL,
    DTYPE VARCHAR2(20) NOT NULL
);

CREATE TABLE CUSTOMER(
    CID VARCHAR2(6) PRIMARY KEY,
    CNAME VARCHAR2(20) NOT NULL,
    CCITY VARCHAR2(20) NOT NULL
);

CREATE TABLE SERVES(
    RID VARCHAR2(6) REFERENCES RESTAURANTS(RID) ON DELETE CASCADE,
    DID VARCHAR2(6) REFERENCES DISHES(DID) ON DELETE CASCADE
);

CREATE TABLE HAS_DISEASE(
    CID VARCHAR2(6) REFERENCES CUSTOMER(CID) ON DELETE CASCADE,
    DID VARCHAR2(6) REFERENCES DISHES(DID) ON DELETE CASCADE,
    TYPE VARCHAR2(20) NOT NULL
);


INSERT INTO RESTAURANTS VALUES(
    'R1',
    'ALTAIR',
    'KOLKATA',
    123456,
    1000
);

INSERT INTO RESTAURANTS VALUES(
    'R2',
    'ROYAL INDIA',
    'KOLKATA',
    1234,
    1000
);


INSERT INTO RESTAURANTS VALUES(
    'R3',
    'VEG',
    'KOLKATA',
    1234343,
    1000
);

INSERT INTO RESTAURANTS VALUES(
    'R4',
    'BENGALI',
    'KOLKATA',
    123443,
    1000
);


INSERT INTO RESTAURANTS VALUES(
    'R5',
    'NON-VEG',
    'MUMBAI',
    123456,
    1000
);

INSERT INTO RESTAURANTS VALUES(
    'R5',
    'ALTAIR',
    'DELHI',
    123456,
    1000
);

INSERT INTO DISHES VALUES(
    'D1',
    'FISH',
    'NON-VEG'
);


INSERT INTO DISHES VALUES(
    'D2',
    'CHICKEN',
    'NON-VEG'
);

INSERT INTO DISHES VALUES(
    'D3',
    'PIZZA',
    'VEG'
);

INSERT INTO DISHES VALUES(
    'D4',
    'BURGER',
    'VEG'
);

INSERT INTO DISHES VALUES(
    'D5',
    'PASTA',
    'VEG'
);


INSERT INTO CUSTOMER1 VALUES(
    'C1',
    'RAJ',
    'KOLKATA'
);
INSERT INTO CUSTOMER1 VALUES(
    'C2',
    'RAHUL',
    'KOLKATA'
);
INSERT INTO CUSTOMER1 VALUES(
    'C4',
    'PRANAV',
    'KOLKATA'
);
INSERT INTO CUSTOMER1 VALUES(
    'C5',
    'PRATIK',
    'MUMBAI'
);
INSERT INTO CUSTOMER1 VALUES(
    'C3',
    'PRANAY',
    'KOLKATA'
);
INSERT INTO CUSTOMER1 VALUES(
    'C6',
    'ROY',
    'KOLKATA'
);

INSERT INTO SERVES VALUES(
    'R1',
    'D1'
);
INSERT INTO SERVES VALUES(
    'R1',
    'D2'
);

INSERT INTO SERVES VALUES(
    'R2',
    'D3'
);
INSERT INTO SERVES VALUES(
    'R2',
    'D1'
);
INSERT INTO SERVES VALUES(
    'R3',
    'D5'
);

INSERT INTO SERVES VALUES(
    'R1',
    'D4'
);

INSERT INTO SERVES VALUES(
    'R2',
    'D4'
);


INSERT INTO HAS_DISEASE VALUES(
    'C6',
    'D1',
    'STOMACH'
);

INSERT INTO HAS_DISEASE VALUES(
    'C1',
    'D2',
    'STOMACH'
);

INSERT INTO HAS_DISEASE VALUES(
    'C2',
    'D4',
    'HEAD'
);

INSERT INTO HAS_DISEASE VALUES(
    'C3',
    'D5',
    'HEAD'
);

INSERT INTO HAS_DISEASE VALUES(
    'C5',
    'D1',
    'STOMACH'
);


SELECT RNAME FROM RESTAURANTS NATURAL JOIN SERVES NATURAL JOIN DISHES WHERE DNAME='BURGER' AND DNAME<>'PIZZA';

SELECT DNAME FROM DISHES WHERE DID NOT IN (
    SELECT DID FROM HAS_DISEASE WHERE CID = (SELECT CID FROM CUSTOMER1 WHERE CNAME='ROY')
)ORDER BY DNAME;

SELECT DNAME FROM DISHES WHERE DID IN (
    SELECT DID FROM SERVES WHERE RID IN (SELECT RID FROM RESTAURANTS WHERE RCITY='KOLKATA')
);


CREATE TABLE EMP1(
    ENO VARCHAR2(6) PRIMARY KEY,
    ENAME VARCHAR2(20) NOT NULL,
    SALARY NUMBER(10,2) NOT NULL
);

INSERT INTO EMP1 VALUES(
    'E1',
    'RAHUL',
    12345678
);

INSERT INTO EMP1 VALUES(
    'E2',
    'PRANAV',
    12345678
);
INSERT INTO EMP1 VALUES(
    'E3',
    'YASH',
    125678
);
INSERT INTO EMP1 VALUES(
    'E4',
    'RONALDO',
    12345678
);
INSERT INTO EMP1 VALUES(
    'E5',
    'MESSI',
    123
);

CURSOR c( in_num NUMBER)

DECLARE  
   e_id EMP1.id%type;  
   c_name customers.name%type;  
   c_addr customers.address%type;  
   CURSOR c_customers is  
      SELECT id, name, address FROM customers;  
BEGIN  
   OPEN c_customers;  
   LOOP  
      FETCH c_customers into c_id, c_name, c_addr;  
      EXIT WHEN c_customers%notfound;  
      dbms_output.put_line(c_id || ' ' || c_name || ' ' || c_addr);  
   END LOOP;  
   CLOSE c_customers;  
END;  
/  


DECLARE
    I NUMBER:=0;
    T NUMBER:=0;
    EID EMP1.ENO%TYPE;
    ENAME EMP1.ENAME%TYPE;
    SALARY EMP1.SALARY%TYPE;
    CURSOR C(IN_NUM NUMBER) IS SELECT ENO,ENAME,SALARY FROM EMP1;
BEGIN
    -- SET SERVEROUTPUT ON
    OPEN C(2);
    LOOP
        FETCH C INTO EID,ENAME,SALARY;
        T:= T+ SALARY;
        EXIT WHEN C%notfound;
        dbms_output.put_line(T);
    END LOOP;
    CLOSE C;
END;
/
    